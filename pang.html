
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Texto An√°rquico Aleatorio</title>
  <style>
    html, body {
      margin: 0; padding: 0;
      width: 100%; height: 100%;
      overflow: hidden;
      background: #111;
      color: #eee;
      font-family: sans-serif;
      position: relative;
    }

    .obj {
      position: absolute;
      cursor: pointer;
      user-select: none;
      white-space: nowrap;
      padding: 20px;      /* √Årea clicable extensa */
      box-sizing: content-box;
      background-color: transparent;
      pointer-events: auto;
      display: inline-block;
      min-width: 40px;
      min-height: 40px;
      text-align: center;
    }
  </style>
</head>
<body>
<p>üëÜ</p>
<script>
(() => {
  // --- Frases aleatorias (reempl√°zalas por las tuyas) ---
  const phrases = [
    "No tengo TDAH, tengo Instagram",
    "No eres t√∫, es Tik Tok",
    "Mi cerebro tras una hora de redes sociales",
  ];
  // Selecci√≥n aleatoria al cargar
  const phraseText = phrases[Math.floor(Math.random() * phrases.length)];
  // -------------------------------------------------------

  const wordsArr = phraseText.split(' ');
  let objects = [];
  let state = 0;
  let nextId = 1;

  function randVel() {
    return (Math.random()*2+1) * (Math.random()<0.5?-1:1);
  }

  function makeObj(text, x, y, vx, vy, type, group, index=null) {
    const el = document.createElement('div');
    el.className = 'obj';
    el.textContent = text;
    document.body.appendChild(el);
    const rect = el.getBoundingClientRect();
    el.dataset.type = type;
    el.dataset.group = group;
    if (index !== null) el.dataset.index = index;
    return { el, text, x, y, vx, vy, w: rect.width, h: rect.height, type, group, index };
  }

  function clearAll() {
    objects.forEach(o => o.el.remove());
    objects = [];
  }

  function initPhrase() {
    clearAll();
    state = 0;
    const x = window.innerWidth/2, y = window.innerHeight/2;
    objects.push(makeObj(phraseText, x, y, randVel(), randVel(), 'phrase', null));
  }

  function toWords() {
    const ph = objects.find(o => o.type==='phrase');
    if (!ph) return;
    clearAll();
    state = 1;
    wordsArr.forEach((w,i) => {
      objects.push(makeObj(w, ph.x, ph.y, randVel(), randVel(), 'word', w, i));
    });
  }

  function toLetters(obj) {
    const letters = Array.from(obj.text);
    const group = obj.group;
    objects = objects.filter(o => o !== obj);
    obj.el.remove();
    letters.forEach((l,i) => {
      objects.push(makeObj(
        l,
        obj.x + i*(obj.w/obj.text.length),
        obj.y,
        randVel(), randVel(),
        'letter',
        group
      ));
    });
  }

  function regroupLetters(group) {
    const letterObjs = objects.filter(o => o.type==='letter' && o.group === group);
    if (letterObjs.length === 0) return;
    const avgX = letterObjs.reduce((s,o)=>s+o.x,0)/letterObjs.length;
    const avgY = letterObjs.reduce((s,o)=>s+o.y,0)/letterObjs.length;
    letterObjs.forEach(o => o.el.remove());
    objects = objects.filter(o => !(o.type==='letter' && o.group === group));
    objects.push(makeObj(group, avgX, avgY, randVel(), randVel(), 'word', group,
                        wordsArr.indexOf(group)));
    checkIfAllWordsRegrouped();
  }

  function checkIfAllWordsRegrouped() {
    const wordSet = new Set(wordsArr);
    const existing = new Set(objects.filter(o => o.type==='word').map(o=>o.group));
    const lettersRemain = objects.some(o => o.type==='letter');
    if (!lettersRemain && wordSet.size === existing.size &&
        [...wordSet].every(w=>existing.has(w))) {
      // reagrupar frase
      const avgX = objects.reduce((s,o)=>s+o.x,0)/objects.length;
      const avgY = objects.reduce((s,o)=>s+o.y,0)/objects.length;
      objects.forEach(o=>o.el.remove());
      objects = [];
      objects.push(makeObj(phraseText, avgX, avgY, randVel(), randVel(), 'phrase', null));
      state = 0;
    }
  }

  document.body.addEventListener('click', e => {
    const target = objects.find(o => o.el===e.target);
    if (!target) return;
    if (state===0 && target.type==='phrase') {
      toWords();
      state = 1;
    } else if (state===1 && target.type==='word') {
      toLetters(target);
    } else if (target.type==='letter') {
      regroupLetters(target.group);
    }
  });

  function animate() {
    const W = window.innerWidth, H = window.innerHeight;
    objects.forEach(o => {
      o.x += o.vx; o.y += o.vy;
      if (o.x < 0 || o.x + o.w > W) o.vx *= -1;
      if (o.y < 0 || o.y + o.h > H) o.vy *= -1;
      o.el.style.transform = `translate(${o.x}px,${o.y}px)`;
    });
    requestAnimationFrame(animate);
  }

  window.addEventListener('resize', () => {
    objects.forEach(o => {
      o.x = Math.min(o.x, window.innerWidth - o.w);
      o.y = Math.min(o.y, window.innerHeight - o.h);
    });
  });

  initPhrase();
  animate();
})();
</script>

</body>
</html>
